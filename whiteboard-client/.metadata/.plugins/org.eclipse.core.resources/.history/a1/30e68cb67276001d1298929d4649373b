package application;

import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

import application.drawings.Line;
import application.drawings.Shape;

/**
 * Actual drawing in on the board happens here
 * 
 * @author aks60
 *
 */
public class GraphicsImplementer {
	
	DrawingPanel panel;
	
	public Lock drawingLock = new ReentrantLock();
	
	enum ShapeType {
		line
	}
	
	public GraphicsImplementer(DrawingPanel panel) {
		this.panel = panel;
	}
	
	public void draw(Line line) {
		drawingLock.lock();
		panel.graphics.drawLine(line.start[0], line.start[1], line.end[0], line.end[1]);
		panel.repaint();
		drawingLock.unlock();
	}

	public static ShapeType decode(String str) {
		ShapeType type = null;
		
		if(strBegins(str, Line.strStart)) return ShapeType.line;
		return type;
	}
	
	public void implement(UpdateGroup group) {
		for(int i = 0; i < group.shapes.size(); i++) {
			Shape shape = group.shapes.get(i);
			if(shape instanceof Line) {
				draw((Line) shape);
			}
		}
	}
	
	public void clear() {
		drawingLock.lock();
		panel.clear();
		drawingLock.unlock();
	}
	
	static boolean strBegins(String str, String compare) {
		int length = compare.length();
		if(length > str.length()) return false;
		String sub = str.substring(0, length);
		if(sub.equals(compare)) return true;
		return false;
	}
	
}
