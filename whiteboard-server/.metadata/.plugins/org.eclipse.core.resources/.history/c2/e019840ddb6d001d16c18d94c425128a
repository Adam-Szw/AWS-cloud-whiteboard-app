package whiteboard_server;

import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.ArrayList;
import java.util.List;

public class Server {
	
	static final int SERVER_PORT = 6668;
	
	String serverState = "";
	public int port;
	public ServerSocket serverSocket;
	
	public Server(int port) throws IOException {
		this.port = port;
		serverSocket = new ServerSocket(port);
	}
	
	List<StateReceiver> stateReceivers = new ArrayList<StateReceiver>();
	StateReceiver updater = null;

	public static void main(String[] args) throws IOException {
		Server server = new Server(SERVER_PORT);
		ClientAccepter accepter = new ClientAccepter(server);
		Thread accepterThread = new Thread(accepter);
		accepterThread.start();
		
		while(true) {
			Socket clientSocket = server.serverSocket.accept();
			StateReceiver stateReceiver = new StateReceiver(server, 6668, server.serverSocket, clientSocket);
			Thread connThread = new Thread(stateReceiver);
			connThread.start();
			server.stateReceivers.add(stateReceiver);
		}
		
	}

}
